#include "mime_type.h"
#include "gts_algorithm.h"

#include <unordered_map>
#include <fstream>

namespace gts::web
{

#define APPLICATION  "application/"
#define AUDIO        "audio/"
#define CHEMICAL     "chemical/"
#define IMAGE        "image/"
#define INODE        "inode/"
#define MESSAGE      "message/"
#define MODEL        "model/"
#define MULTIPART    "multipart/"
#define TEXT         "text/"
#define VIDEO        "video/"

static std::unordered_map<std::string, std::string> g_suffix_hash
{
	{ ".1"             , TEXT "troff"                                                                  },
	{ ".3ds"           , IMAGE "x-3ds"                                                                 },
	{ ".3fr"           , IMAGE "x-raw-hasselblad"                                                      },
	{ ".3g2"           , VIDEO "3gpp2"                                                                 },
	{ ".3gp"           , VIDEO "3gpp"                                                                  },
	{ ".3mf"           , APPLICATION "vnd.ms-package.3dmanufacturing-3dmodel+xml"                      },
	{ ".4th"           , TEXT "x-forth"                                                                },
	{ ".669"           , "audio/x-mod"                                                                 },
	{ ".6pl"           , TEXT "x-perl"                                                                 },
	{ ".7z"            , "application/x-7z-compressed"                                                 },
	{ ".8svx"          , "audio/8svx"                                                                  },
	{ ".ML"            , TEXT "x-ocaml"                                                                },
	{ ".MYD"           , "application/x-mysql-misam-data"                                              },
	{ ".MYI"           , "application/x-mysql-misam-compressed-index"                                  },
	{ ".R"             , TEXT "x-rsrc"                                                                 },
	{ ".TIF"           , "image/tiff"                                                                  },
	{ ".XXX"           , "application/octet-stream"                                                    },
	{ ".Z"             , "application/x-compress"                                                      },
	{ ".aa"            , "audio/x-pn-audibleaudio"                                                     },
	{ ".ac3"           , "audio/ac3"                                                                   },
	{ ".acsm"          , "application/vnd.adobe.adept+xml"                                             },
	{ ".ada"           , TEXT "x-ada"                                                                  },
	{ ".adf"           , "multipart/appledouble"                                                       },
	{ ".afa"           , "application/x-astrotite-afa"                                                 },
	{ ".afm"           , "application/x-font-adobe-metric"                                             },
	{ ".ai"            , "application/illustrator"                                                     },
	{ ".aif"           , "audio/x-aiff"                                                                },
	{ ".aifc"          , "audio/x-aiff"                                                                },
	{ ".aiff"          , "audio/x-aiff"                                                                },
	{ ".air"           , "application/vnd.adobe.air-application-installer-package+zip;version=\"1.0\"" },
	{ ".aj"            , TEXT "x-aspectj"                                                              },
	{ ".amr"           , "audio/amr"                                                                   },
	{ ".anim"          , TEXT "x-yaml"                                                                 },
	{ ".anpa"          , TEXT "vnd.iptc.anpa"                                                          },
	{ ".ans"           , TEXT "plain"                                                                  },
	{ ".apl"           , TEXT "apl"                                                                    },
	{ ".apng"          , "image/vnd.mozilla.apng"                                                      },
	{ ".applescript"   , TEXT "x-applescript"                                                          },
	{ ".apr"           , "application/vnd.lotus-approach;version=\"97\""                               },
	{ ".apt"           , "application/vnd.lotus-approach"                                              },
	{ ".arc"           , "application/x-internet-archive;version=\"1.0\""                              },
	{ ".arw"           , "image/x-raw-sony"                                                            },
	{ ".as"            , TEXT "x-actionscript"                                                         },
	{ ".asc"           , TEXT "plain"                                                                  },
	{ ".asciidoc"      , TEXT "x-asciidoc"                                                             },
	{ ".asf"           , "application/vnd.ms-asf"                                                      },
	{ ".asice"         , "application/vnd.etsi.asic-e+zip"                                             },
	{ ".asics"         , "application/vnd.etsi.asic-s+zip"                                             },
	{ ".asn"           , TEXT "x-ttcn-asn"                                                             },
	{ ".asp"           , "application/x-aspx"                                                          },
	{ ".aspx"          , TEXT "aspdotnet"                                                              },
	{ ".asy"           , TEXT "x-spreadsheet"                                                          },
	{ ".atom"          , "application/atom+xml"                                                        },
	{ ".au"            , "audio/basic"                                                                 },
	{ ".avi"           , "video/msvideo"                                                               },
	{ ".awb"           , "audio/amr-wb"                                                                },
	{ ".awk"           , TEXT "x-awk"                                                                  },
	{ ".axc"           , TEXT "plain"                                                                  },
	{ ".axx"           , "application/x-axcrypt"                                                       },
	{ ".b"             , TEXT "x-brainfuck"                                                            },
	{ ".b6z"           , "application/x-b6z-compressed"                                                },
	{ ".bas"           , TEXT "x-basic"                                                                },
	{ ".bay"           , "image/x-raw-casio"                                                           },
	{ ".bik"           , "video/vnd.radgamettools.bink"                                                },
	{ ".bik2"          , "video/vnd.radgamettools.bink;version=\"2\""                                  },
	{ ".bin"           , "application/x-macbinary"                                                     },
	{ ".bmp"           , "image/bmp"                                                                   },
	{ ".bpg"           , "image/x-bpg"                                                                 },
	{ ".bpm"           , "application/bizagi-modeler"                                                  },
	{ ".bsp"           , "model/vnd.valve.source.compiled-map"                                         },
	{ ".btf"           , "image/tiff"                                                                  },
	{ ".bw"            , "image/x-sgi-bw"                                                              },
	{ ".bz2"           , "application/x-bzip2"                                                         },
	{ ".c"             , TEXT "x-csrc"                                                                 },
	{ ".cab"           , "application/vnd.ms-cab-compressed"                                           },
	{ ".cabal"         , TEXT "x-haskell"                                                              },
	{ ".cap"           , "application/vnd.tcpdump.pcap"                                                },
	{ ".catmaterial"   , "application/octet-stream;version=\"5\""                                      },
	{ ".catpart"       , "application/octet-stream;version=\"5\""                                      },
	{ ".catproduct"    , "application/octet-stream;version=\"5\""                                      },
	{ ".cbl"           , TEXT "x-cobol"                                                                },
	{ ".cbor"          , "application/cbor"                                                            },
	{ ".cbz"           , "application/x-cbr"                                                           },
	{ ".cca"           , "application/octet-stream"                                                    },
	{ ".cda"           , "application/x-cdf"                                                           },
	{ ".cdf"           , "application/x-netcdf"                                                        },
	{ ".cdx"           , "chemical/x-cdx"                                                              },
	{ ".cfm"           , TEXT "x-coldfusion"                                                           },
	{ ".cfs"           , "application/x-cfs-compressed"                                                },
	{ ".cgi"           , TEXT "x-cgi"                                                                  },
	{ ".cgm"           , "image/cgm"                                                                   },
	{ ".chm"           , "application/vnd.ms-htmlhelp"                                                 },
	{ ".chrt"          , "application/x-kchart"                                                        },
	{ ".chs"           , TEXT "x-haskell"                                                              },
	{ ".cif"           , "chemical/x-cif"                                                              },
	{ ".ck"            , TEXT "x-java"                                                                 },
	{ ".cl"            , TEXT "x-common-lisp"                                                          },
	{ ".class"         , "application/x-java"                                                          },
	{ ".clj"           , TEXT "x-clojure"                                                              },
	{ ".cls"           , TEXT "x-vbasic"                                                               },
	{ ".cmake"         , TEXT "x-cmake"                                                                },
	{ ".cml"           , "chemical/x-cml"                                                              },
	{ ".cob"           , TEXT "x-cobol"                                                                },
	{ ".cod"           , "image/cis-cod"                                                               },
	{ ".coffee"        , "application/vnd.coffeescript"                                                },
	{ ".cp"            , TEXT "x-pascal"                                                               },
	{ ".cpio"          , "application/x-cpio"                                                          },
	{ ".cpp"           , TEXT "x-c++src"                                                               },
	{ ".cr"            , TEXT "x-crystal"                                                              },
	{ ".crw"           , "image/x-canon-crw"                                                           },
	{ ".crx"           , "application/x-chrome-package"                                                },
	{ ".cs"            , TEXT "x-csharp"                                                               },
	{ ".cshtml"        , TEXT "html"                                                                   },
	{ ".cson"          , TEXT "x-coffeescript"                                                         },
	{ ".csr"           , "application/pkcs10"                                                          },
	{ ".css"           , TEXT "css"                                                                    },
	{ ".csv"           , TEXT "csv"                                                                    },
	{ ".csvs"          , TEXT "csv-schema"                                                             },
	{ ".cu"            , TEXT "x-c++src"                                                               },
	{ ".cur"           , "image/x-win-bitmap"                                                          },
	{ ".cwl"           , TEXT "x-yaml"                                                                 },
	{ ".cy"            , TEXT "javascript"                                                             },
	{ ".d"             , TEXT "x-d"                                                                    },
	{ ".dae"           , TEXT "xml"                                                                    },
	{ ".dart"          , "application/dart"                                                            },
	{ ".dat"           , "application/dbase"                                                           },
	{ ".db"            , "application/x-sqlite3"                                                       },
	{ ".dbf"           , "application/x-dbf"                                                           },
	{ ".dcm"           , "application/dicom"                                                           },
	{ ".dcr"           , "application/x-director"                                                      },
	{ ".dcx"           , "image/x-dcx"                                                                 },
	{ ".deb"           , "application/vnd.debian.binary-package"                                       },
	{ ".der"           , "application/x-x509-ca-cert"                                                  },
	{ ".dex"           , "application/x-dex"                                                           },
	{ ".dgc"           , "application/x-dgc-compressed"                                                },
	{ ".diff"          , TEXT "x-diff"                                                                 },
	{ ".dir"           , "application/x-director"                                                      },
	{ ".dita"          , "application/dita+xml;format=topic"                                           },
	{ ".ditamap"       , "application/dita+xml;format=map"                                             },
	{ ".ditaval"       , "application/dita+xml;format=val"                                             },
	{ ".diz"           , TEXT "plain"                                                                  },
	{ ".djv"           , "image/vnd.djvu"                                                              },
	{ ".djvu"          , "image/vnd.djvu"                                                              },
	{ ".dll"           , "application/octet-stream"                                                    },
	{ ".dls"           , "audio/dls"                                                                   },
	{ ".dmg"           , "application/x-apple-diskimage"                                               },
	{ ".dng"           , "image/x-raw-adobe"                                                           },
	{ ".doc"           , "application/msword"                                                          },
	{ ".dockerfile"    , TEXT "x-dockerfile"                                                           },
	{ ".docm"          , "application/vnd.ms-word.document.macroenabled.12"                            },
	{ ".docx"          , "application/vnd.openxmlformats-officedocument.wordprocessingml.document"     },
	{ ".dot"           , "application/msword;version=\"97-2003\""                                      },
	{ ".dotm"          , "application/vnd.ms-word.template.macroenabled.12"                            },
	{ ".dotx"          , "application/vnd.openxmlformats-officedocument.wordprocessingml.template"     },
	{ ".dpx"           , "image/x-dpx"                                                                 },
	{ ".drc"           , "video/x-dirac"                                                               },
	{ ".druby"         , TEXT "x-ruby"                                                                 },
	{ ".dtd"           , "application/xml-dtd"                                                         },
	{ ".dts"           , "audio/vnd.dts"                                                               },
	{ ".dv"            , "video/dv"                                                                    },
	{ ".dvi"           , "application/x-dvi"                                                           },
	{ ".dwf"           , "application/dwf;version=\"6.0\""                                             },
	{ ".dwfx"          , "model/vnd.dwfx+xps"                                                          },
	{ ".dwg"           , "image/vnd.dwg"                                                               },
	{ ".dwl"           , "application/octet-stream"                                                    },
	{ ".dx"            , "application/dec-dx."                                                         },
	{ ".dxb"           , "image/vnd.dxb"                                                               },
	{ ".dxf"           , "image/vnd.dxf"                                                               },
	{ ".dxr"           , "audio/prs.sid;version=\"1\""                                                 },
	{ ".dylan"         , TEXT "x-dylan"                                                                },
	{ ".e"             , TEXT "x-eiffel"                                                               },
	{ ".eb"            , TEXT "x-python"                                                               },
	{ ".ebnf"          , TEXT "x-ebnf"                                                                 },
	{ ".ebuild"        , TEXT "x-sh"                                                                   },
	{ ".ecl"           , TEXT "x-ecl"                                                                  },
	{ ".eclass"        , TEXT "x-sh"                                                                   },
	{ ".ecr"           , TEXT "html"                                                                   },
	{ ".edc"           , "application/json"                                                            },
	{ ".edn"           , TEXT "x-clojure"                                                              },
	{ ".eex"           , TEXT "html"                                                                   },
	{ ".el"            , TEXT "x-emacs-lisp"                                                           },
	{ ".elc"           , "application/x-elc"                                                           },
	{ ".elm"           , TEXT "x-elm"                                                                  },
	{ ".em"            , TEXT "x-coffeescript"                                                         },
	{ ".emf"           , "image/emf"                                                                   },
	{ ".eml"           , "message/rfc822"                                                              },
	{ ".enr"           , "application/x-endnote-refer"                                                 },
	{ ".ens"           , "application/x-endnote-style"                                                 },
	{ ".enz"           , "application/x-endnote-connect"                                               },
	{ ".eot"           , "application/vnd.ms-fontobject"                                               },
	{ ".epj"           , "application/json"                                                            },
	{ ".eps"           , "application/postscript"                                                      },
	{ ".epub"          , "application/epub+zip"                                                        },
	{ ".eq"            , TEXT "x-csharp"                                                               },
	{ ".erb"           , "application/x-erb"                                                           },
	{ ".erf"           , "image/x-raw-epson"                                                           },
	{ ".erl"           , TEXT "x-erlang"                                                               },
	{ ".es"            , "application/ecmascript"                                                      },
	{ ".exe"           , "application/x-dosexec"                                                       },
	{ ".exp"           , TEXT "x-expect"                                                               },
	{ ".exr"           , "image/x-exr;version=\"2\""                                                   },
	{ ".f"             , TEXT "x-fortran"                                                              },
	{ ".f4a"           , "video/mp4"                                                                   },
	{ ".f4m"           , "application/f4m"                                                             },
	{ ".f90"           , TEXT "x-fortran"                                                              },
	{ ".factor"        , TEXT "x-factor"                                                               },
	{ ".fb2"           , "application/x-fictionbook+xml"                                               },
	{ ".fdf"           , "application/vnd.fdf"                                                         },
	{ ".fff"           , "image/x-raw-imacon"                                                          },
	{ ".fh"            , "image/x-freehand"                                                            },
	{ ".fig"           , "application/x-matlab-data"                                                   },
	{ ".fits"          , "image/fits"                                                                  },
	{ ".flac"          , "audio/flac"                                                                  },
	{ ".flif"          , "image/flif"                                                                  },
	{ ".flv"           , "video/x-flv"                                                                 },
	{ ".fm"            , "application/vnd.framemaker"                                                  },
	{ ".fmz"           , "application/octet-stream"                                                    },
	{ ".folio"         , "application/vnd.adobe.folio+zip"                                             },
	{ ".fp7"           , "application/x-filemaker"                                                     },
	{ ".fpx"           , "image/vnd.fpx"                                                               },
	{ ".fref"          , TEXT "plain"                                                                  },
	{ ".fs"            , TEXT "x-fsharp"                                                               },
	{ ".fth"           , TEXT "x-forth"                                                                },
	{ ".g3"            , "image/g3fax"                                                                 },
	{ ".gbr"           , "application/vnd.gerber"                                                      },
	{ ".gca"           , "application/x-gca-compressed"                                                },
	{ ".geo"           , "application/vnd.geogebra.file;version=\"1.0\""                               },
	{ ".gf"            , TEXT "x-haskell"                                                              },
	{ ".ggb"           , "application/vnd.geogebra.file"                                               },
	{ ".gif"           , "image/gif"                                                                   },
	{ ".gitconfig"     , TEXT "x-properties"                                                           },
	{ ".gitignore"     , TEXT "x-sh"                                                                   },
	{ ".glf"           , TEXT "x-tcl"                                                                  },
	{ ".gml"           , "application/gml+xml"                                                         },
	{ ".gn"            , TEXT "x-python"                                                               },
	{ ".gnumeric"      , "application/x-gnumeric"                                                      },
	{ ".go"            , TEXT "x-go"                                                                   },
	{ ".grb"           , "application/x-grib"                                                          },
	{ ".groovy"        , TEXT "x-groovy"                                                               },
	{ ".gsp"           , "application/x-jsp"                                                           },
	{ ".gtar"          , "application/x-gtar"                                                          },
	{ ".gz"            , "application/gzip"                                                            },
	{ ".h"             , TEXT "x-chdr"                                                                 },
	{ ".haml"          , TEXT "x-haml"                                                                 },
	{ ".hcl"           , TEXT "x-ruby"                                                                 },
	{ ".hdf"           , "application/x-hdf"                                                           },
	{ ".hdp"           , "image/vnd.ms-photo"                                                          },
	{ ".hdr"           , "image/vnd.radiance"                                                          },
	{ ".hh"            , "application/x-httpd-php"                                                     },
	{ ".hpgl"          , "application/vnd.hp-hpgl"                                                     },
	{ ".hpp"           , TEXT "x-c++hdr"                                                               },
	{ ".hqx"           , "application/mac-binhex"                                                      },
	{ ".hs"            , TEXT "x-haskell"                                                              },
	{ ".htm"           , TEXT "html"                                                                   },
	{ ".html"          , TEXT "html"                                                                   },
	{ ".http"          , "message/http"                                                                },
	{ ".hx"            , TEXT "x-haxe"                                                                 },
	{ ".ibooks"        , "application/x-ibooks+zip"                                                    },
	{ ".ico"           , "image/vnd.microsoft.icon"                                                    },
	{ ".ics"           , TEXT "calendar"                                                               },
	{ ".idl"           , TEXT "x-idl"                                                                  },
	{ ".idml"          , "application/vnd.adobe.indesign-idml-package"                                 },
	{ ".iges"          , "model/iges;version=\"5.x\""                                                  },
	{ ".igs"           , "model/iges"                                                                  },
	{ ".iiq"           , "image/x-raw-phaseone"                                                        },
	{ ".ind"           , "application/octet-stream;version=\"generic\""                                },
	{ ".indd"          , "application/x-adobe-indesign"                                                },
	{ ".inf"           , "application/inf"                                                             },
	{ ".ini"           , TEXT "x-ini"                                                                  },
	{ ".inx"           , "application/x-adobe-indesign-interchange"                                    },
	{ ".ipa"           , "application/x-itunes-ipa"                                                    },
	{ ".ipynb"         , "application/json"                                                            },
	{ ".irclog"        , TEXT "mirc"                                                                   },
	{ ".iso"           , "application/x-iso9660-image"                                                 },
	{ ".itk"           , "application/x-tcl"                                                           },
	{ ".j2c"           , "image/x-jp2-codestream"                                                      },
	{ ".jade"          , TEXT "x-pug"                                                                  },
	{ ".jar"           , "application/java-archive"                                                    },
	{ ".java"          , TEXT "x-java"                                                                 },
	{ ".jinja"         , TEXT "x-django"                                                               },
	{ ".jl"            , TEXT "x-julia"                                                                },
	{ ".jls"           , "image/jls"                                                                   },
	{ ".jng"           , "image/x-jng"                                                                 },
	{ ".jnilib"        , "application/x-java-jnilib"                                                   },
	{ ".jp2"           , "image/jpx"                                                                   },
	{ ".jpe"           , "image/jpeg"                                                                  },
	{ ".jpf"           , "image/jpx"                                                                   },
	{ ".jpg"           , "image/jpeg"                                                                  },
	{ ".jpm"           , "image/jpm"                                                                   },
	{ ".jq"            , "application/json"                                                            },
	{ ".js"            , "application/javascript"                                                      },
	{ ".json"          , "application/json"                                                            },
	{ ".json-patch"    , "application/json-patch+json"                                                 },
	{ ".json5"         , "application/json"                                                            },
	{ ".jsonld"        , "application/ld+json"                                                         },
	{ ".jsp"           , "application/x-jsp"                                                           },
	{ ".jsx"           , TEXT "jsx"                                                                    },
	{ ".jxr"           , "image/jxr"                                                                   },
	{ ".k25"           , "image/x-raw-kodak"                                                           },
	{ ".kicad_pcb"     , TEXT "x-common-lisp"                                                          },
	{ ".kid"           , TEXT "xml"                                                                    },
	{ ".kil"           , "application/x-killustrator"                                                  },
	{ ".kit"           , TEXT "html"                                                                   },
	{ ".kml"           , "application/vnd.google-earth.kml+xml"                                        },
	{ ".kmz"           , "application/vnd.google-earth.kmz"                                            },
	{ ".kpr"           , "application/x-kpresenter"                                                    },
	{ ".kra"           , "application/x-krita"                                                         },
	{ ".ksp"           , "application/x-kspread"                                                       },
	{ ".kt"            , TEXT "x-kotlin"                                                               },
	{ ".ktx"           , "image/ktx"                                                                   },
	{ ".kwd"           , "application/x-kword"                                                         },
	{ ".l"             , TEXT "x-lex"                                                                  },
	{ ".latex"         , "application/x-latex"                                                         },
	{ ".latte"         , TEXT "x-smarty"                                                               },
	{ ".less"          , TEXT "x-less"                                                                 },
	{ ".lfe"           , TEXT "x-common-lisp"                                                          },
	{ ".lha"           , "application/x-lzh-compressed"                                                },
	{ ".lhs"           , TEXT "x-literate-haskell"                                                     },
	{ ".lisp"          , TEXT "x-common-lisp"                                                          },
	{ ".log"           , TEXT "x-log"                                                                  },
	{ ".lookml"        , TEXT "x-yaml"                                                                 },
	{ ".ls"            , TEXT "x-livescript"                                                           },
	{ ".lua"           , TEXT "x-lua"                                                                  },
	{ ".lvproj"        , TEXT "xml"                                                                    },
	{ ".lwp"           , "application/vnd.lotus-wordpro"                                               },
	{ ".lz"            , "application/x-lzip"                                                          },
	{ ".lzma"          , "application/x-lzma"                                                          },
	{ ".m"             , TEXT "x-objcsrc"                                                              },
	{ ".m3"            , TEXT "x-modula"                                                               },
	{ ".m3u"           , "audio/x-mpegurl"                                                             },
	{ ".maff"          , "application/x-maff"                                                          },
	{ ".mak"           , TEXT "x-cmake"                                                                },
	{ ".marko"         , TEXT "html"                                                                   },
	{ ".mas"           , "application/vnd.lotus-freelance"                                             },
	{ ".mat"           , "application/matlab-mat"                                                      },
	{ ".mathematica"   , TEXT "x-mathematica"                                                          },
	{ ".matlab"        , TEXT "x-octave"                                                               },
	{ ".maxpat"        , "application/json"                                                            },
	{ ".mbox"          , "application/mbox"                                                            },
	{ ".mbx"           , "application/mbox"                                                            },
	{ ".mcw"           , "application/msword;version=\"5.0\""                                          },
	{ ".md"            , TEXT "markdown"                                                               },
	{ ".mdi"           , "image/vnd.ms-modi"                                                           },
	{ ".mef"           , "image/x-raw-mamiya"                                                          },
	{ ".metal"         , TEXT "x-c++src"                                                               },
	{ ".mht"           , "multipart/related"                                                           },
	{ ".mid"           , "audio/midi"                                                                  },
	{ ".mif"           , "application/x-mif"                                                           },
	{ ".mix"           , "image/vnd.mix"                                                               },
	{ ".mj2"           , "video/mj2"                                                                   },
	{ ".mkv"           , "video/x-matroska"                                                            },
	{ ".ml"            , TEXT "x-ocaml"                                                                },
	{ ".mlp"           , "audio/vnd.dolby.mlp"                                                         },
	{ ".mm"            , "application/x-freemind"                                                      },
	{ ".mmp"           , "application/vnd.mindjet.mindmanager"                                         },
	{ ".mmr"           , "image/vnd.fujixerox.edmics-mmr"                                              },
	{ ".mng"           , "video/x-mng"                                                                 },
	{ ".mo"            , TEXT "x-modelica"                                                             },
	{ ".mobi"          , "application/x-mobipocket-ebook"                                              },
	{ ".mod"           , "application/octet-stream;version=\"4\""                                      },
	{ ".mol"           , "chemical/x-mdl-molfile"                                                      },
	{ ".mos"           , "image/x-raw-leaf"                                                            },
	{ ".mov"           , "video/quicktime"                                                             },
	{ ".mp1"           , "audio/mpeg"                                                                  },
	{ ".mp2"           , "audio/mpeg"                                                                  },
	{ ".mp3"           , "audio/mpeg"                                                                  },
	{ ".mp4"           , "video/mp4"                                                                   },
	{ ".mpeg"          , "video/mpeg"                                                                  },
	{ ".mpg"           , "video/mpeg"                                                                  },
	{ ".mpga"          , "audio/mpeg"                                                                  },
	{ ".mpp"           , "application/vnd.ms-project;version=\"2010\""                                 },
	{ ".mpx"           , "application/x-project;version=\"4.0\""                                       },
	{ ".mrc"           , "application/marc"                                                            },
	{ ".mrw"           , "image/x-raw-minolta"                                                         },
	{ ".msg"           , "application/vnd.ms-outlook"                                                  },
	{ ".msi"           , "application/x-msi"                                                           },
	{ ".mso"           , "application/x-mso"                                                           },
	{ ".mtml"          , TEXT "html"                                                                   },
	{ ".muf"           , TEXT "x-forth"                                                                },
	{ ".mumps"         , TEXT "x-mumps"                                                                },
	{ ".mxf"           , "application/mxf"                                                             },
	{ ".mxl"           , "application/vnd.recordare.musicxml"                                          },
	{ ".mxmf"          , "audio/mobile-xmf"                                                            },
	{ ".n3"            , TEXT "n3"                                                                     },
	{ ".nap"           , "image/naplps"                                                                },
	{ ".nb"            , "application/mathematica"                                                     },
	{ ".nc"            , "application/x-netcdf"                                                        },
	{ ".nef"           , "image/x-raw-nikon"                                                           },
	{ ".nfo"           , TEXT "x-nfo"                                                                  },
	{ ".nginxconf"     , TEXT "x-nginx-conf"                                                           },
	{ ".nif"           , "application/vnd.music-niff"                                                  },
	{ ".nl"            , TEXT "x-common-lisp"                                                          },
	{ ".nlogo"         , TEXT "x-common-lisp"                                                          },
	{ ".ns2"           , "application/vnd.lotus-notes;version=\"2\""                                   },
	{ ".ns3"           , "application/vnd.lotus-notes;version=\"3\""                                   },
	{ ".ns4"           , "application/vnd.lotus-notes;version=\"4\""                                   },
	{ ".nsf"           , "application/vnd.lotus-notes"                                                 },
	{ ".nsi"           , TEXT "x-nsis"                                                                 },
	{ ".ntf"           , "application/vnd.nitf"                                                        },
	{ ".nu"            , TEXT "x-scheme"                                                               },
	{ ".numpy"         , TEXT "x-python"                                                               },
	{ ".nut"           , TEXT "x-c++src"                                                               },
	{ ".ocaml"         , TEXT "x-ocaml"                                                                },
	{ ".odb"           , "application/vnd.oasis.opendocument.database"                                 },
	{ ".odc"           , "application/vnd.oasis.opendocument.chart"                                    },
	{ ".odf"           , "application/vnd.oasis.opendocument.formula"                                  },
	{ ".odft"          , "application/vnd.oasis.opendocument.formula-template"                         },
	{ ".odg"           , "application/vnd.oasis.opendocument.graphics"                                 },
	{ ".odi"           , "application/vnd.oasis.opendocument.image"                                    },
	{ ".odm"           , "application/vnd.oasis.opendocument.text-master"                              },
	{ ".odp"           , "application/vnd.oasis.opendocument.presentation"                             },
	{ ".ods"           , "application/vnd.oasis.opendocument.spreadsheet"                              },
	{ ".odt"           , "application/vnd.oasis.opendocument.text"                                     },
	{ ".ofx"           , "application/x-ofx;version=\"2.1.1\""                                         },
	{ ".oga"           , "audio/ogg"                                                                   },
	{ ".ogg"           , "audio/ogg"                                                                   },
	{ ".ogm"           , "video/x-ogm"                                                                 },
	{ ".ogv"           , "video/ogg"                                                                   },
	{ ".ogx"           , "application/ogg"                                                             },
	{ ".one"           , "application/msonenote"                                                       },
	{ ".opf"           , "application/x-dtbook+xml"                                                    },
	{ ".opus"          , "audio/opus"                                                                  },
	{ ".ora"           , "image/openraster"                                                            },
	{ ".orf"           , "image/x-raw-olympus"                                                         },
	{ ".otc"           , "application/vnd.oasis.opendocument.chart-template"                           },
	{ ".otf"           , "application/x-font-otf"                                                      },
	{ ".otg"           , "application/vnd.oasis.opendocument.graphics-template"                        },
	{ ".oth"           , "application/vnd.oasis.opendocument.text-web"                                 },
	{ ".oti"           , "application/vnd.oasis.opendocument.image-template"                           },
	{ ".otm"           , "application/vnd.oasis.opendocument.text-master"                              },
	{ ".otp"           , "application/vnd.oasis.opendocument.presentation-template"                    },
	{ ".ots"           , "application/vnd.oasis.opendocument.spreadsheet-template"                     },
	{ ".ott"           , "application/vnd.oasis.opendocument.text-template"                            },
	{ ".oxps"          , "application/oxps"                                                            },
	{ ".oz"            , TEXT "x-oz"                                                                   },
	{ ".p"             , TEXT "x-pascal"                                                               },
	{ ".p65"           , "application/vnd.pagemaker"                                                   },
	{ ".pab"           , "application/vnd.ms-outlook"                                                  },
	{ ".pack"          , "application/package"                                                         },
	{ ".pam"           , "image/x-portable-arbitrarymap"                                               },
	{ ".pas"           , TEXT "x-pascal"                                                               },
	{ ".pbm"           , "image/x-portable-bitmap"                                                     },
	{ ".pcap"          , "application/vnd.tcpdump.pcap"                                                },
	{ ".pcapng"        , "application/vnd.tcpdump.pcap"                                                },
	{ ".pcl"           , "application/vnd.hp-pcl"                                                      },
	{ ".pct"           , "image/x-pict;version=\"2.0\""                                                },
	{ ".pcx"           , "image/vnd.zbrush.pcx"                                                        },
	{ ".pdb"           , "application/vnd.palm"                                                        },
	{ ".pdf"           , "application/pdf"                                                             },
	{ ".pfm"           , "application/x-font-printer-metric"                                           },
	{ ".pfr"           , "application/font-tdpfr"                                                      },
	{ ".pgm"           , "image/x-portable-graymap"                                                    },
	{ ".pgn"           , "application/x-chess-pgn"                                                     },
	{ ".pgsql"         , TEXT "x-sql"                                                                  },
	{ ".php"           , TEXT "x-php"                                                                  },
	{ ".phtml"         , "application/x-httpd-php"                                                     },
	{ ".pic"           , "image/x-pict"                                                                },
	{ ".pict"          , "image/x-pict"                                                                },
	{ ".pkpass"        , "application/vnd.apple.pkpass"                                                },
	{ ".pl"            , TEXT "x-perl"                                                                 },
	{ ".pls"           , TEXT "x-plsql"                                                                },
	{ ".png"           , "image/png"                                                                   },
	{ ".pnm"           , "image/x-portable-anymap"                                                     },
	{ ".pod"           , TEXT "x-perl"                                                                 },
	{ ".por"           , "application/x-spss-por"                                                      },
	{ ".potm"          , "application/vnd.ms-powerpoint.template.macroenabled.12;version=\"2007\""     },
	{ ".potx"          , "application/vnd.openxmlformats-officedocument.presentationml.template"       },
	{ ".pp"            , TEXT "x-puppet"                                                               },
	{ ".ppam"          , "application/vnd.ms-powerpoint.addin.macroenabled.12"                         },
	{ ".ppm"           , "image/x-portable-pixmap"                                                     },
	{ ".pps"           , "application/vnd.ms-powerpoint;version=\"97-2003\""                           },
	{ ".ppsm"          , "application/vnd.ms-powerpoint.slideshow.macroenabled.12"                     },
	{ ".ppsx"          , "application/vnd.openxmlformats-officedocument.presentationml.slideshow"      },
	{ ".ppt"           , "application/vnd.ms-powerpoint"                                               },
	{ ".pptm"          , "application/vnd.ms-powerpoint.presentation.macroenabled.12"                  },
	{ ".pptx"          , "application/vnd.openxmlformats-officedocument.presentationml.presentation"   },
	{ ".prc"           , "application/vnd.palm"                                                        },
	{ ".pro"           , TEXT "x-prolog"                                                               },
	{ ".project"       , "application/octet-stream;version=\"4\""                                      },
	{ ".properties"    , TEXT "properties"                                                             },
	{ ".proto"         , TEXT "x-protobuf"                                                             },
	{ ".ps"            , "application/postscript"                                                      },
	{ ".ps1"           , "application/x-powershell"                                                    },
	{ ".psb"           , "image/vnd.adobe.photoshop"                                                   },
	{ ".psd"           , "image/vnd.adobe.photoshop"                                                   },
	{ ".psid"          , "audio/prs.sid;version=\"2\""                                                 },
	{ ".pst"           , "application/vnd.ms-outlook-pst"                                              },
	{ ".ptx"           , "image/x-raw-pentax"                                                          },
	{ ".purs"          , TEXT "x-haskell"                                                              },
	{ ".pxn"           , "image/x-raw-logitech"                                                        },
	{ ".py"            , TEXT "x-python"                                                               },
	{ ".pyx"           , TEXT "x-cython"                                                               },
	{ ".qcd"           , "application/vnd.quark.quarkxpress"                                           },
	{ ".qcp"           , "audio/qcelp"                                                                 },
	{ ".qif"           , "application/qif"                                                             },
	{ ".qxp"           , "application/vnd.quark.quarkxpress"                                           },
	{ ".qxp report"    , "application/vnd.quark.quarkxpress"                                           },
	{ ".r"             , TEXT "x-rsrc"                                                                 },
	{ ".r3d"           , "image/x-raw-red"                                                             },
	{ ".ra"            , "audio/vnd.rn-realaudio"                                                      },
	{ ".raf"           , "image/x-raw-fuji"                                                            },
	{ ".ram"           , "audio/vnd.rn-realaudio"                                                      },
	{ ".raml"          , TEXT "x-yaml"                                                                 },
	{ ".rar"           , "application/vnd.rar"                                                         },
	{ ".rar "          , "application/vnd.rar"                                                         },
	{ ".ras"           , "image/x-sun-raster"                                                          },
	{ ".raw"           , "image/x-raw-panasonic"                                                       },
	{ ".rb"            , TEXT "x-ruby"                                                                 },
	{ ".rdf"           , "application/rdf+xml"                                                         },
	{ ".re"            , TEXT "x-rustsrc"                                                              },
	{ ".reg"           , TEXT "x-properties"                                                           },
	{ ".rest"          , TEXT "x-rst"                                                                  },
	{ ".rexx"          , TEXT "x-rexx"                                                                 },
	{ ".rf64"          , "audio/x-wav;version=\"0waveformatextensibleencoding\""                       },
	{ ".rfa"           , "application/octet-stream"                                                    },
	{ ".rft"           , "application/octet-stream"                                                    },
	{ ".rg"            , TEXT "x-clojure"                                                              },
	{ ".rgb"           , "image/x-rgb"                                                                 },
	{ ".rhtml"         , "application/x-erb"                                                           },
	{ ".rlc"           , "image/vnd.fujixerox.edmics-rlc"                                              },
	{ ".rm"            , "application/vnd.rn-realmedia"                                                },
	{ ".rmd"           , TEXT "x-gfm"                                                                  },
	{ ".rmi"           , "audio/mid"                                                                   },
	{ ".rmp"           , "audio/x-pn-realaudio-plugin"                                                 },
	{ ".roff"          , TEXT "troff"                                                                  },
	{ ".rpm"           , "application/x-rpm"                                                           },
	{ ".rs"            , TEXT "x-rustsrc"                                                              },
	{ ".rss"           , "application/rss+xml"                                                         },
	{ ".rst"           , TEXT "x-rst"                                                                  },
	{ ".rte"           , "application/octet-stream"                                                    },
	{ ".rtf"           , "application/rtf"                                                             },
	{ ".rv"            , "video/vnd.rn-realvideo"                                                      },
	{ ".rvg"           , "application/octet-stream"                                                    },
	{ ".rvt"           , "application/octet-stream"                                                    },
	{ ".rws"           , "application/octet-stream"                                                    },
	{ ".rwz"           , "image/x-raw-rawzor"                                                          },
	{ ".s"             , TEXT "x-asm"                                                                  },
	{ ".s7m"           , "application/x-sas-dmdb"                                                      },
	{ ".sa7"           , "application/x-sas-access"                                                    },
	{ ".sage"          , TEXT "x-python"                                                               },
	{ ".sam"           , "application/vnd.lotus-wordpro"                                               },
	{ ".sas"           , "application/x-sas"                                                           },
	{ ".sas7bbak"      , "application/x-sas-backup"                                                    },
	{ ".sass"          , TEXT "x-sass"                                                                 },
	{ ".sav"           , "application/x-spss-sav"                                                      },
	{ ".sc7"           , "application/x-sas-catalog"                                                   },
	{ ".scala"         , TEXT "x-scala"                                                                },
	{ ".sch"           , TEXT "xml"                                                                    },
	{ ".scm"           , TEXT "x-scheme"                                                               },
	{ ".scores"        , TEXT "plain"                                                                  },
	{ ".scss"          , TEXT "x-scss"                                                                 },
	{ ".sd7"           , "application/x-sas-data"                                                      },
	{ ".sda"           , "application/vnd.stardivision.draw"                                           },
	{ ".sdc"           , "application/vnd.stardivision.calc"                                           },
	{ ".sdn"           , TEXT "plain"                                                                  },
	{ ".sdw"           , "application/vnd.stardivision.writer"                                         },
	{ ".sed"           , TEXT "x-sed"                                                                  },
	{ ".sf7"           , "application/x-sas-fdb"                                                       },
	{ ".sfd"           , "application/vnd.font-fontforge-sfd"                                          },
	{ ".sgm"           , TEXT "sgml"                                                                   },
	{ ".sgml"          , TEXT "sgml"                                                                   },
	{ ".sh"            , "application/x-sh"                                                            },
	{ ".sh-session"    , TEXT "x-sh"                                                                   },
	{ ".shar"          , "application/x-shar"                                                          },
	{ ".shtml"         , TEXT "x-server-parsed-html"                                                   },
	{ ".si7"           , "application/x-sas-data-index"                                                },
	{ ".sid"           , "audio/prs.sid"                                                               },
	{ ".sit"           , "application/x-stuffit"                                                       },
	{ ".sitx"          , "application/x-stuffitx"                                                      },
	{ ".skb"           , "application/octet-stream"                                                    },
	{ ".skp"           , "application/vnd.koan"                                                        },
	{ ".sla"           , "application/vnd.scribus"                                                     },
	{ ".sld"           , "application/sld"                                                             },
	{ ".sldm"          , "application/vnd.ms-powerpoint.slide.macroenabled.12;version=\"2007\""        },
	{ ".sldprt"        , "application/sldworks"                                                        },
	{ ".slim"          , TEXT "x-slim"                                                                 },
	{ ".sls"           , TEXT "x-yaml"                                                                 },
	{ ".sm7"           , "application/x-sas-mddb"                                                      },
	{ ".smi"           , "application/smil+xml"                                                        },
	{ ".smk"           , "video/vnd.radgamettools.smacker"                                             },
	{ ".soy"           , TEXT "x-soy"                                                                  },
	{ ".sp7"           , "application/x-sas-putility"                                                  },
	{ ".sparql"        , "application/sparql-query"                                                    },
	{ ".spec"          , TEXT "x-rpm-spec"                                                             },
	{ ".spl"           , "application/x-futuresplash"                                                  },
	{ ".spx"           , "audio/speex"                                                                 },
	{ ".sql"           , TEXT "x-sql"                                                                  },
	{ ".sr7"           , "application/x-sas-itemstor"                                                  },
	{ ".srl"           , "application/sereal"                                                          },
	{ ".srt"           , TEXT "x-common-lisp"                                                          },
	{ ".ss7"           , "application/x-sas-program-data"                                              },
	{ ".ssml"          , "application/ssml+xml"                                                        },
	{ ".st"            , TEXT "x-stsrc"                                                                },
	{ ".st7"           , "application/x-sas-audit"                                                     },
	{ ".stw"           , "application/vnd.sun.xml.writer.template"                                     },
	{ ".stx"           , "application/x-sas-transport"                                                 },
	{ ".su7"           , "application/x-sas-utility"                                                   },
	{ ".sublime-build" , TEXT "javascript"                                                             },
	{ ".sv"            , TEXT "x-systemverilog"                                                        },
	{ ".sv7"           , "application/x-sas-view"                                                      },
	{ ".svf"           , "image/vnd.svf"                                                               },
	{ ".svg"           , "image/svg+xml"                                                               },
	{ ".svgz"          , "image/svg+xml"                                                               },
	{ ".swf"           , "application/vnd.adobe.flash-movie"                                           },
	{ ".swift"         , TEXT "x-swift"                                                                },
	{ ".sxc"           , "application/vnd.sun.xml.calc;version=\"1.0\""                                },
	{ ".sxd"           , "application/vnd.sun.xml.draw"                                                },
	{ ".sxi"           , "application/vnd.sun.xml.impress"                                             },
	{ ".sxw"           , "application/vnd.sun.xml.writer"                                              },
	{ ".sz"            , "application/x-snappy-framed"                                                 },
	{ ".t"             , "application/x-tads"                                                          },
	{ ".tap"           , "image/vnd.tencent.tap"                                                       },
	{ ".tar"           , "application/x-tar"                                                           },
	{ ".tcl"           , TEXT "x-tcl"                                                                  },
	{ ".tcsh"          , TEXT "x-sh"                                                                   },
	{ ".tex"           , TEXT "x-tex"                                                                  },
	{ ".textile"       , TEXT "x-textile"                                                              },
	{ ".tfw"           , TEXT "plain"                                                                  },
	{ ".tfx"           , "image/tiff"                                                                  },
	{ ".thmx"          , "application/vnd.ms-officetheme"                                              },
	{ ".tif"           , "image/tiff"                                                                  },
	{ ".tif "          , "image/tiff"                                                                  },
	{ ".tiff"          , "image/tiff"                                                                  },
	{ ".toml"          , TEXT "x-toml"                                                                 },
	{ ".torrent"       , "application/x-bittorrent"                                                    },
	{ ".tpl"           , TEXT "x-smarty"                                                               },
	{ ".ts"            , "application/typescript"                                                      },
	{ ".tsv"           , TEXT "tab-separated-values"                                                   },
	{ ".tta"           , "audio/tta;version=\"1\""                                                     },
	{ ".ttf"           , "application/x-font-ttf"                                                      },
	{ ".ttl"           , TEXT "turtle"                                                                 },
	{ ".twig"          , TEXT "x-twig"                                                                 },
	{ ".txt"           , TEXT "plain"                                                                  },
	{ ".u3d"           , "model/u3d"                                                                   },
	{ ".uc"            , TEXT "x-java"                                                                 },
	{ ".ulx"           , "application/x-glulx"                                                         },
	{ ".uno"           , TEXT "x-csharp"                                                               },
	{ ".upc"           , TEXT "x-csrc"                                                                 },
	{ ".url"           , "application/x-url"                                                           },
	{ ".v"             , TEXT "x-verilog"                                                              },
	{ ".vb"            , TEXT "x-vb"                                                                   },
	{ ".vbs"           , TEXT "x-vbscript"                                                             },
	{ ".vcd"           , "application/x-cdlink"                                                        },
	{ ".vcf"           , TEXT "vcard"                                                                  },
	{ ".vcs"           , TEXT "x-vcalendar"                                                            },
	{ ".vdx"           , "application/vnd.visio;version=\"2003-2010\""                                 },
	{ ".vhd"           , TEXT "x-vhdl"                                                                 },
	{ ".vhdl"          , TEXT "x-vhdl"                                                                 },
	{ ".viv"           , "video/vnd-vivo"                                                              },
	{ ".vmdk"          , "application/x-vmdk"                                                          },
	{ ".vmt"           , "application/vnd.valve.source.material"                                       },
	{ ".volt"          , TEXT "x-d"                                                                    },
	{ ".vot"           , "application/x-votable+xml"                                                   },
	{ ".vpb"           , "image/vpb"                                                                   },
	{ ".vsd"           , "application/vnd.visio"                                                       },
	{ ".vsdm"          , "application/vnd.ms-visio.drawing.macroenabled.12"                            },
	{ ".vsdx"          , "application/vnd.visio"                                                       },
	{ ".vssm"          , "application/vnd.ms-visio.stencil.macroenabled.12"                            },
	{ ".vssx"          , "application/vnd.ms-visio.stencil"                                            },
	{ ".vstm"          , "application/vnd.ms-visio.template.macroenabled.12"                           },
	{ ".vstx"          , "application/vnd.ms-visio.template"                                           },
	{ ".vtf"           , "image/vnd.valve.source.texture"                                              },
	{ ".vtt"           , TEXT "vtt"                                                                    },
	{ ".vwx"           , "application/vnd.vectorworks;version=\"2015\""                                },
	{ ".w50"           , "application/vnd.wordperfect;version=\"5.0\""                                 },
	{ ".w51"           , "application/vnd.wordperfect;version=\"5.1\""                                 },
	{ ".w52"           , "application/vnd.wordperfect;version=\"5.2\""                                 },
	{ ".warc"          , "application/warc"                                                            },
	{ ".wast"          , TEXT "x-common-lisp"                                                          },
	{ ".wav"           , "audio/x-wav"                                                                 },
	{ ".wbmp"          , "image/vnd.wap.wbmp"                                                          },
	{ ".webapp"        , "application/x-web-app-manifest+json"                                         },
	{ ".webidl"        , TEXT "x-webidl"                                                               },
	{ ".webm"          , "video/webm"                                                                  },
	{ ".webp"          , "image/webp"                                                                  },
	{ ".wisp"          , TEXT "x-clojure"                                                              },
	{ ".wk1"           , "application/vnd.lotus-1-2-3;version=\"2.0\""                                 },
	{ ".wk3"           , "application/vnd.lotus-1-2-3;version=\"3.0\""                                 },
	{ ".wk4"           , "application/vnd.lotus-1-2-3;version=\"4-5\""                                 },
	{ ".wks"           , "application/vnd.lotus-1-2-3"                                                 },
	{ ".wma"           , "audio/x-ms-wma"                                                              },
	{ ".wmf"           , "image/wmf"                                                                   },
	{ ".wmlc"          , "application/vnd.wap.wmlc"                                                    },
	{ ".wmls"          , TEXT "vnd.wap.wmlscript"                                                      },
	{ ".wmlsc"         , "application/vnd.wap.wmlscriptc"                                              },
	{ ".wmv"           , "video/x-ms-wmv"                                                              },
	{ ".woff"          , "application/font-woff"                                                       },
	{ ".wp4"           , "application/vnd.wordperfect;version=\"4.0/4.1/4.2\""                         },
	{ ".wpd"           , "application/vnd.wordperfect"                                                 },
	{ ".wpl"           , "application/vnd.ms-wpl"                                                      },
	{ ".wrl"           , "model/vrml"                                                                  },
	{ ".wsz"           , "interface/x-winamp-skin"                                                     },
	{ ".x3d"           , "model/x3d+xml"                                                               },
	{ ".x3f"           , "image/x-raw-sigma"                                                           },
	{ ".xap"           , "application/x-silverlight-app"                                               },
	{ ".xar"           , "application/vnd.xara"                                                        },
	{ ".xbm"           , "image/x-xbitmap"                                                             },
	{ ".xc"            , TEXT "x-csrc"                                                                 },
	{ ".xcf"           , "image/xcf"                                                                   },
	{ ".xdm"           , "image/x-xwindowdump;version=\"x10\""                                         },
	{ ".xfdf"          , "application/vnd.adobe.xfdf"                                                  },
	{ ".xhtml"         , "application/xhtml+xml"                                                       },
	{ ".xif"           , "image/vnd.xiff"                                                              },
	{ ".xla"           , "application/vnd.ms-excel;version=\"4.0\""                                    },
	{ ".xlam"          , "application/vnd.ms-excel.addin.macroenabled.12"                              },
	{ ".xlc"           , "application/vnd.ms-excel;version=\"3.0\""                                    },
	{ ".xlm"           , "application/vnd.ms-excel;version=\"3.0\""                                    },
	{ ".xls"           , "application/vnd.ms-excel"                                                    },
	{ ".xlsb"          , "application/vnd.ms-excel.sheet.binary.macroenabled.12"                       },
	{ ".xlsm"          , "application/vnd.ms-excel.sheet.macroenabled.12"                              },
	{ ".xlsx"          , "application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"           },
	{ ".xltm"          , "application/vnd.ms-excel.template.macroenabled.12"                           },
	{ ".xltx"          , "application/vnd.openxmlformats-officedocument.spreadsheetml.template"        },
	{ ".xlw"           , "application/vnd.ms-excel;version=\"4w\""                                     },
	{ ".xm"            , "audio/xm"                                                                    },
	{ ".xmf"           , "audio/mobile-xmf"                                                            },
	{ ".xmind"         , "application/x-xmind"                                                         },
	{ ".xml"           , "application/xml"                                                             },
	{ ".xmt"           , "application/mpeg4-iod-xmt"                                                   },
	{ ".xpi"           , "application/x-xpinstall"                                                     },
	{ ".xpl"           , TEXT "xml"                                                                    },
	{ ".xpm"           , "image/x-xpixmap;version=\"x10\""                                             },
	{ ".xps"           , "application/oxps"                                                            },
	{ ".xpt"           , "application/x-sas-xport"                                                     },
	{ ".xq"            , "application/xquery"                                                          },
	{ ".xquery"        , "application/xquery"                                                          },
	{ ".xs"            , TEXT "x-csrc"                                                                 },
	{ ".xsd"           , "application/xml"                                                             },
	{ ".xsl"           , "application/xml"                                                             },
	{ ".xslfo"         , "application/xslfo+xml"                                                       },
	{ ".xslt"          , "application/xslt+xml"                                                        },
	{ ".xsp-config"    , TEXT "xml"                                                                    },
	{ ".xspf"          , "application/xspf+xml"                                                        },
	{ ".xwd"           , "image/x-xwindowdump"                                                         },
	{ ".xz"            , "application/x-xz"                                                            },
	{ ".y"             , TEXT "x-yacc"                                                                 },
	{ ".yaml"          , TEXT "x-yaml"                                                                 },
	{ ".yml"           , TEXT "x-yaml"                                                                 },
	{ ".zip"           , "application/zip"                                                             }
};

static const char* g_signatures_list[] =
{
	"\x05" "\x00\x01\x00\x00\x00"                           , APPLICATION "x-font-ttf"             ,
	"\x0C" "\x04%!PS-Adobe-"                                , APPLICATION "postscript"             ,
	"\x0D" "\x1B%-12345X%!PS"                               , APPLICATION "postscript"             ,
	"\x02" "\x1F\x8B"                                       , APPLICATION "gzip"/*x-gzip*/         ,
	"\x02" "\x1F\x9D"                                       , APPLICATION "x-compress"             ,
	"\x0E" "!<arch>""\x0A""debian"                          , APPLICATION "x-debian-package"       ,
	"\x08" "#! rnews"                                       , MESSAGE "rfc822"                     ,
	"\x0A" "#!/bin/ash"                                     , APPLICATION "x-shellscript"          ,
	"\x0B" "#!/bin/bash"                                    , APPLICATION "x-shellscript"          ,
	"\x0B" "#!/bin/perl"                                    , TEXT "x-perl"                        ,
	"\x09" "#!/bin/sh"                                      , APPLICATION "x-shellscript"          ,
	"\x12" "#!/usr/bin/env lua"                             , TEXT "x-lua"                         ,
	"\x0F" "#!/usr/bin/perl"                                , TEXT "x-perl"                        ,
	"\x15" "#!/usr/bin/env python"                          , TEXT "x-python"                      ,
	"\x13" "#!/usr/bin/env ruby"                            , TEXT "x-ruby"                        ,
	"\x12" "#!/usr/bin/env tcl"                             , TEXT "x-tcl"                         ,
	"\x13" "#!/usr/bin/env wish"                            , TEXT "x-tcl"                         ,
	"\x0E" "#!/usr/bin/lua"                                 , TEXT "x-lua"                         ,
	"\x11" "#!/usr/bin/python"                              , TEXT "x-python"                      ,
	"\x0F" "#!/usr/bin/ruby"                                , TEXT "x-ruby"                        ,
	"\x0E" "#!/usr/bin/tcl"                                 , TEXT "x-tcl"                         ,
	"\x0F" "#!/usr/bin/wish"                                , TEXT "x-tcl"                         ,
	"\x14" "#!/usr/local/bin/lua"                           , TEXT "x-lua"                         ,
	"\x15" "#!/usr/local/bin/perl"                          , TEXT "x-perl"                        ,
	"\x17" "#!/usr/local/bin/python"                        , TEXT "x-python"                      ,
	"\x15" "#!/usr/local/bin/ruby"                          , TEXT "x-ruby"                        ,
	"\x14" "#!/usr/local/bin/tcl"                           , TEXT "x-tcl"                         ,
	"\x15" "#!/usr/local/bin/wish"                          , TEXT "x-tcl"                         ,
	"\x11" "# KDE Config File"                              , APPLICATION "x-kdelnk"               ,
	"\x14" "# PaCkAgE DaTaStReAm"                           , APPLICATION "x-svr4-package"         ,
	"\x06" "# xmcd"                                         , TEXT "x-xmcd"                        ,
	"\x0B" "#?RADIANCE\x0A"                                 , IMAGE "vnd.radiance"                 ,
	"\x0B" "%!PS-Adobe-"                                    , APPLICATION "postscript"             ,
	"\x05" "%PDF-"                                          , APPLICATION "pdf"                    ,
	"\x05" "*mbx*"                                          , APPLICATION "mbox"                   ,
	"\x1C" "-----BEGIN PGP MESSAGE-\x00\x1E---"             , APPLICATION "pgp"                    ,
	"\x1E" "-----BEGIN PGP SIGNATURE-\x00\x03.\""           , APPLICATION "pgp-signature"          ,
	"\x03" ".\""                                            , TEXT "troff"                         ,
	"\x04" ".sd\x00"                                        , AUDIO "x-dec-basic"                  ,
	"\x04" ".snd"                                           , AUDIO "basic"                        ,
	"\x09" "/* XPM */"                                      , IMAGE "x-xpmi"                       ,
	"\x05" "07070"                                          , APPLICATION "x-cpio"                 ,
	"\x04" "1\xBE\x00\x00"                                  , APPLICATION "msword"                 ,
	"\x06" "7z\xBC\xAF'\x1C"                                , APPLICATION "x-7z-compressed"        ,
	"\x1A" "8BPS Adobe Photoshop Image"                     , IMAGE "vnd.adobe.photoshop"          ,
	"\x04" ";ELC"                                           , APPLICATION "x-elc"                  ,
	"\x0E" "<!DOCTYPE HTML"                                 , TEXT "html"                          ,
	"\x0E" "<?xml version="                                 , APPLICATION "xml"                    ,
	"\x06" "<Book "                                         , APPLICATION "x-mif"                  ,
	"\x09" "<BookFile"                                      , APPLICATION "x-mif"                  ,
	"\x04" "<MML"                                           , APPLICATION "x-mif"                  ,
	"\x08" "<MIFFile"                                       , APPLICATION "x-mif"                  ,
	"\x10" "<MakerDictionary"                               , APPLICATION "x-mif"                  ,
	"\x06" "<Maker"                                         , APPLICATION "x-mif"                  ,
	"\x0C" "<SCRIBUSUTF8"                                   , APPLICATION "x-scribus"              ,
	"\x0C" "<map version"                                   , APPLICATION "x-freemind"             ,
	"\x0A" "@ echo off"                                     , TEXT "x-msdos-batch"                 ,
	"\x09" "@echo off"                                      , TEXT "x-msdos-batch"                 ,
	"\x04" "@rem"                                           , TEXT "x-msdos-batch"                 ,
	"\x04" "@set"                                           , TEXT "x-msdos-batch"                 ,
	"\x04" "ADIF"                                           , AUDIO "x-hx-aac-adif"                ,
	"\x08" "AT&TFORM"                                       , IMAGE "vnd.djvu"                     ,
	"\x07" "Article"                                        , MESSAGE "news"                       ,
	"\x0F" "BEGIN:VCALENDAR"                                , TEXT "calendar"                      ,
	"\x0B" "BEGIN:VCARD"                                    , TEXT "x-vcard"                       ,
	"\x04" "BM\x00\x03"                                     , IMAGE "x-ms-bmp"                     ,
	"\x03" "BZh"                                            , APPLICATION "x-bzip2"                ,
	"\x04" "CPC\xB2"                                        , IMAGE "x-cpi"                        ,
	"\x03" "CWS"                                            , APPLICATION "x-shockwave-flash"      ,
	"\x04" "DICM"                                           , APPLICATION "dicom"                  ,
	"\x04" "EIM "                                           , IMAGE "x-eim"                        ,
	"\x06" "FGF95a"                                         , IMAGE "x-unknown"                    ,
	"\x03" "FLV"                                            , VIDEO "x-flv"                        ,
	"\x04" "FOVb"                                           , IMAGE "x-x3f"                        ,
	"\x03" "FWS"                                            , APPLICATION "x-shockwave-flash"      ,
	"\x0A" "Forward to"                                     , MESSAGE "rfc822"                     ,
	"\x05" "From:"                                          , MESSAGE "rfc822"                     ,
	"\x04" "GIF8"                                           , IMAGE "gif"                          ,
	"\x06" "GIF94z"                                         , IMAGE "x-unknown"                    ,
	"\x0A" "HEADER    "                                     , CHEMICAL "x-pdb"                     ,
	"\x11" "HWP Document File"                              , APPLICATION "x-hwp"                  ,
	"\x0E" "II\x1A\x00\x00\x00HEAPCCDR"                     , IMAGE "x-canon-crw"                  ,
	"\x04" "II*\x00"                                        , IMAGE "tiff"                         ,
	"\x0A" "II*\x00\x10\x00\x00\x00CR"                      , IMAGE "x-canon-cr2"                  ,
	"\x04" "IIN1"                                           , IMAGE "x-niff"                       ,
	"\x04" "IIRO"                                           , IMAGE "x-olympus-orf"                ,
	"\x04" "IIRS"                                           , IMAGE "x-olympus-orf"                ,
	"\x04" "LRZI"                                           , APPLICATION "x-lrzip"                ,
	"\x04" "LZIP"                                           , APPLICATION "x-lzip"                 ,
	"\x0E" "MAS_UTrack_V00"                                 , AUDIO "x-mod"                        ,
	"\x04" "MM\x00*"                                        , IMAGE "tiff"                         ,
	"\x04" "MMOR"                                           , IMAGE "x-olympus-orf"                ,
	"\x04" "MOVI"                                           , VIDEO "x-sgi-movie"                  ,
	"\x04" "MThd"                                           , AUDIO "midi"                         ,
	"\x02" "MZ"                                             , APPLICATION "x-dosexec"              ,
	"\x09" "N#! rnews"                                      , MESSAGE "rfc822"                     ,
	"\x04" "OTTO"                                           , APPLICATION "vnd.ms-opentype"        ,
	"\x04" "OggS"                                           , APPLICATION "ogg"                    ,
	"\x03" "P4\x00"                                         , IMAGE "x-portable-bitmap"            ,
	"\x03" "P5\x00"                                         , IMAGE "x-portable-greymap"           ,
	"\x03" "P6\x00"                                         , IMAGE "x-portable-pixmap"            ,
	"\x03" "P7\x00"                                         , IMAGE "x-portable-pixmap"            ,
	"\x0C" "P7\n#MTPAINT#"                                  , IMAGE "x-portable-multimap"          ,
	"\x03" "PBF"                                            , IMAGE "x-unknown"                    ,
	"\x04" "PDN3"                                           , IMAGE "x-paintnet"                   ,
	"\x05" "PFS1\x0A"                                       , IMAGE "x-pfs"                        ,
	"\x04" "PK\x03\x04"                                     , APPLICATION "zip"                    ,
	"\x08" "PK\x07\x08PK\x03\x04"                           , APPLICATION "zip"                    ,
	"\x08" "PK00PK\x03\x04"                                 , APPLICATION "zip"                    ,
	"\x05" "PO^Q`"                                          , APPLICATION "msword"                 ,
	"\x05" "Path:"                                          , MESSAGE "news"                       ,
	"\x07" "Pipe to"                                        , MESSAGE "rfc822"                     ,
	"\x10" "RF64\xFF\xFF\xFF\xFFWAVEds64"                   , AUDIO "x-wav"                        ,
	"\x04" "Rar!"                                           , APPLICATION "x-rar"                  ,
	"\x09" "Received:"                                      , MESSAGE "rfc822"                     ,
	"\x0E" "Relay-Version:"                                 , MESSAGE "rfc822"                     ,
	"\x0C" "Return-Path:"                                   , MESSAGE "rfc822"                     ,
	"\x04" "SIT!"                                           , APPLICATION "x-stuffit"              ,
	"\x0D" "SplineFontDB:"                                  , APPLICATION "vnd.font-fontforge-sfd" ,
	"\x08" "StuffIt\x00"                                    , APPLICATION "x-stuffit"              ,
	"\x04" "WARC"                                           , APPLICATION "warc"                   ,
	"\x04" "Xcur"                                           , IMAGE "x-xcursor"                    ,
	"\x05" "Xref:"                                          , MESSAGE "news"                       ,
	"\x13" "[KDE Desktop Entry]"                            , APPLICATION "x-kdelnk"               ,
	"\x0B" "d8:announce"                                    , APPLICATION "x-bittorrent"           ,
	"\x04" "drpm"                                           , APPLICATION "x-rpm"                  ,
	"\x04" "fLaC"                                           , AUDIO "x-flac"                       ,
	"\x0B" "filedesc://"                                    , APPLICATION "x-ia-arc"               ,
	"\x10" "riff.\x91\xCF\x11\xA5\xD6(\xDB\x04\xC1\x00\x00" , AUDIO "x-w64"                        ,
	"\x05" "\rtf\x00"                                       , TEXT "rtf"                           ,
	"\x09" "\x89LZO\x00\x0D\x0A\x1A\x0A"                    , APPLICATION "x-lzop"                 ,
	"\x08" "\x89PNG\x0D\x0A\x1A\x0A"                        , IMAGE "png"                          ,
	"\x04" "\x8AJNG"                                        , VIDEO "x-jng"                        ,
	"\x04" "\x8AMNG"                                        , VIDEO "x-mng"                        ,
	"\x08" "\x89HDF\x0D\x0A\x1A\x0A"                        , APPLICATION "x-hdf"                  ,
	"\x04" "\xCE\xCE\xCE\xCE"                               , APPLICATION "x-java-jce-keystore"    ,
	"\x06" "\xFD""7zXZ\x00"                                 , APPLICATION "x-xz"                   ,
	"\x04" "\xFE""7\x00#"                                   , APPLICATION "msword"                 ,
	"\x02" "\xFF\xD8"                                       , IMAGE "jpeg"                         ,
	"\x04" "\xFF\xD8\xFF\xE0"                               , IMAGE "jpeg"                         ,
	"\x04" "\xFF\xD8\xFF\xEE"                               , IMAGE "jpeg"
};

static const char *g_signatures_list4[] =
{
	"\x0D" "\x0AVersion:Vivo"             , VIDEO "vivo"                     ,
	"\x07" "#VRML V"                      , MODEL "vrml"                     ,
	"\x1C" "-BEGIN PGP PUBLIC KEY BLOCK-" , APPLICATION "pgp-keys"           ,
	"\x04" "XPR3"                         , APPLICATION "x-quark-xpress-3"   ,
	"\x04" "XPRa"                         , APPLICATION "x-quark-xpress-3"   ,
	"\x04" "free"                         , VIDEO "quicktime"                ,
	"\x07" "ftyp3g2"                      , VIDEO "3gpp2"                    ,
	"\x07" "ftyp3ge"                      , VIDEO "3gpp"                     ,
	"\x07" "ftyp3gg"                      , VIDEO "3gpp"                     ,
	"\x07" "ftyp3gp"                      , VIDEO "3gpp"                     ,
	"\x07" "ftyp3gs"                      , VIDEO "3gpp"                     ,
	"\x07" "ftypM4A"                      , AUDIO "mp4"                      ,
	"\x07" "ftypM4B"                      , VIDEO "quicktime"                ,
	"\x07" "ftypM4P"                      , VIDEO "quicktime"                ,
	"\x07" "ftypM4V"                      , VIDEO "mp4"                      ,
	"\x08" "ftypavc1"                     , VIDEO "3gpp"                     ,
	"\x08" "ftypiso2"                     , VIDEO "mp4"                      ,
	"\x08" "ftypisom"                     , VIDEO "mp4"                      ,
	"\x07" "ftypjp2"                      , IMAGE "jp2"                      ,
	"\x08" "ftypmmp4"                     , VIDEO "mp4"                      ,
	"\x08" "ftypmp41"                     , VIDEO "mp4"                      ,
	"\x08" "ftypmp42"                     , VIDEO "mp4"                      ,
	"\x08" "ftypmp7b"                     , VIDEO "mp4"                      ,
	"\x08" "ftypmp7t"                     , VIDEO "mp4"                      ,
	"\x06" "ftypqt"                       , VIDEO "quicktime"                ,
	"\x04" "idat"                         , VIDEO "quicktime"                ,
	"\x04" "idsc"                         , VIDEO "quicktime"                ,
	"\x02" "jP"                           , IMAGE "jp2"                      ,
	"\x04" "mdat"                         , VIDEO "quicktime"                ,
	"\x04" "pckg"                         , APPLICATION "x-quicktime-player" ,
	"\x04" "skip"                         , VIDEO "quicktime"                ,
	"\x04" "wide"                         , VIDEO "quicktime"
};

#define _LEN(x)  ( sizeof(x) / sizeof(x[0]) - 2 )

static inline std::string __mime_search(const char **mimes, size_t len, const char *buf)
{
	std::size_t bot = 0;
	std::size_t top = len;

	std::size_t i = ((bot + top) >> 1) & ~1;
	int cmp = 0;

	for(; bot<=top and i<=len; i=((bot+top)>>1)&(~1))
	{
		cmp = memcmp(buf, mimes[i]+1, *mimes[i]);
		if( cmp == 0 )
			return mimes[i+1]; //match found

		else if( cmp > 0 )
			bot = i + 2;
		else
			top = i - 2;
	}
	return "unknown";
}

static inline bool __is_text_file(std::fstream &file)
{
	char buf[0x4000] = "";
	auto buf_size = file.readsome(buf, sizeof(buf));
	std::string data(buf, buf_size);

	// UTF16 byte order marks
	if( starts_with(data, "\xFE\xFF") or starts_with(data, "\xFF\xFE") )
		return true;

	// Check the first 128 bytes (see shared-mime spec)
	const char *p = buf;
	const char *e = p + (128<buf_size? 128:buf_size);

	for(; p<e; p++)
	{
		if( static_cast<unsigned char>(*p) < 32 and *p != 9 and *p != 10 and *p != 13 )
			return false;
	}
	return true;
}

#define _BUF_LEN  256

static inline std::string mime_from_magic(const std::string &file_name)
{
	std::fstream file(file_name);
	if( not file.is_open() )
		return "unknown";

	char buf[_BUF_LEN] = {0};
	auto size = file.readsome(buf, _BUF_LEN);

	if( size < _BUF_LEN )
	{
		file.seekg(0, std::ios_base::beg);
		if( __is_text_file(file) )
		{
			file.close();
			return "text/plain";
		}
		file.close();
//		return "unknwon";
	}

	auto mime_type = __mime_search(g_signatures_list, _LEN(g_signatures_list), buf);
	if( mime_type.empty() )
		mime_type = __mime_search(g_signatures_list4, _LEN(g_signatures_list4), buf + 4);
	return mime_type;
}

std::string get_mime_type(const std::string &file_name)
{
	auto name = file_name;
	auto pos = file_name.rfind("/");

	if( pos != std::string::npos )
		name = file_name.substr(pos + 1);

	if( name.empty() )
		return "unkown";

	pos = name.rfind('.');
	if( pos == std::string::npos )
		return mime_from_magic(file_name);

	auto it = g_suffix_hash.find(to_lower(name.substr(pos)));
	if( it == g_suffix_hash.end() )
		return mime_from_magic(file_name);

	return it->second;
}

bool is_text_file(const std::string &file_name)
{
	std::fstream file(file_name);
	if( file.is_open() )
	{
		__is_text_file(file);
		file.close();
		return true;
	}
	return false;
}

std::string get_text_file_encoding(const std::string &file_name)
{
	std::string result = "unknown";
	FILE *fp = std::fopen(file_name.c_str(), "rb");

	if( not fp )
		return result;

	// A is just a place holder
	unsigned char first_byte  = std::fgetc(fp);
	unsigned char second_byte = not std::feof(fp)? std::fgetc(fp) : 'A';
	unsigned char third_byte  = not std::feof(fp)? std::fgetc(fp) : 'A';
	unsigned char fourth_byte = not std::feof(fp)? std::fgetc(fp) : 'A';

	if( first_byte == 0xEF and second_byte == 0xBB and third_byte == 0xBF )
		result = "UTF-8";

	else if( first_byte == 0xFF and second_byte == 0xFE )
		result = "UTF-16LE";

	else if( first_byte == 0xFE and second_byte == 0xFF )
		result =  "UTF-16BE";

	else if( first_byte == 0xFF and second_byte == 0xFE and third_byte == 0x0 and fourth_byte == 0x0)
		result = "UTF-32LE";

	else if( first_byte == 0x00 and second_byte == 0x00 and third_byte == 0xFE and fourth_byte == 0xFF)
		result = "UTF-32BE";

	return result;
}

} //namespace gts::web
